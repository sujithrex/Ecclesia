<!DOCTYPE html>
<html>
<head>
    <title>Generated PDF from InDesign - PDF-lib</title>
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
</head>
<body>
    <h1>InDesign to PDF-lib Generator</h1>
    <p>Page Size: 595 x 842 points</p>
    <p>Orientation: portrait</p>
    <p>Found 72 shape(s) in the document</p>
    <div id="imageInputs"></div>
    <button onclick="viewPDF()">View PDF in Browser</button>
    <p><strong>Debug:</strong> Open browser console (F12) to see any errors</p>

    <script>
        // Global variable to store loaded images
        const loadedImages = {};
        
        // Initialize image inputs on page load
        window.addEventListener("load", function() {
            initializeImageInputs();
        });
        
        function initializeImageInputs() {
            const imageInputsContainer = document.getElementById("imageInputs");
        }
        
        async function loadImage(imageIndex, inputElement) {
            const file = inputElement.files[0];
            if (file) {
                try {
                    const arrayBuffer = await file.arrayBuffer();
                    loadedImages[imageIndex] = {
                        bytes: arrayBuffer,
                        type: file.type
                    };
                    console.log(`Image ${imageIndex} loaded: ${file.name} (${file.type})`);
                } catch (error) {
                    console.error(`Error loading image ${imageIndex}:`, error);
                }
            }
        }
        
        async function viewPDF() {
            try {
                console.log("Starting PDF generation for viewing...");
                
                // Create a new PDF document
                const pdfDoc = await PDFLib.PDFDocument.create();
                
                // Add a page with custom dimensions
                const page = pdfDoc.addPage([595.28, 841.89]);
                const { width, height } = page.getSize();
                
                console.log(`Page size: ${width} x ${height} points`);
                
                // Draw all shapes from InDesign document
                
                // Line 1 (Layer order: 71)
                page.drawLine({
                    start: { x: 36.62, y: 762.52 },
                    end: { x: 558.78, y: 762.52 },
                    thickness: 1.00,
                    color: PDFLib.rgb(0.000, 0.000, 0.000)
                });
                
                // Line 2 (Layer order: 70)
                page.drawLine({
                    start: { x: 36.91, y: 675.42 },
                    end: { x: 558.77, y: 675.42 },
                    thickness: 1.00,
                    color: PDFLib.rgb(0.000, 0.000, 0.000)
                });
                
                // Line 3 (Layer order: 69)
                page.drawLine({
                    start: { x: 36.96, y: 652.60 },
                    end: { x: 558.77, y: 652.60 },
                    thickness: 1.00,
                    color: PDFLib.rgb(0.000, 0.000, 0.000)
                });
                
                // Text Frame 4 (Layer order: 68) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 88.44pt)
                    const wrappedLines = wrapText("Family Number :", font, 12, 88.44);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 756.00 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 743.24 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 744.00;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 744.00;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 743.24) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 39.69,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Family Number :", {
                        x: 39.69,
                        y: 744.00,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 5 (Layer order: 67) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 88.44pt)
                    const wrappedLines = wrapText("Mobile Number :", font, 12, 88.44);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 755.29 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 742.54 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 743.29;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 743.29;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 742.54) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 297.85,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Mobile Number :", {
                        x: 297.85,
                        y: 743.29,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 6 (Layer order: 66) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 88.44pt)
                    const wrappedLines = wrapText("Family Head :", font, 12, 88.44);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 737.22 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 724.47 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 725.22;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 725.22;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 724.47) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 39.69,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Family Head :", {
                        x: 39.69,
                        y: 725.22,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 7 (Layer order: 65) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 88.44pt)
                    const wrappedLines = wrapText("Address :", font, 12, 88.44);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 718.45 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 705.69 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 706.45;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 706.45;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 705.69) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 39.69,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Address :", {
                        x: 39.69,
                        y: 706.45,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 8 (Layer order: 64) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 88.44pt)
                    const wrappedLines = wrapText("Area :", font, 12, 88.44);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 736.52 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 723.76 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 724.52;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 724.52;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 723.76) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 297.85,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Area :", {
                        x: 297.85,
                        y: 724.52,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 9 (Layer order: 63) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 88.44pt)
                    const wrappedLines = wrapText("Prayer Points :", font, 12, 88.44);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 717.74 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 704.98 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 705.74;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 705.74;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 704.98) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 297.13,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Prayer Points :", {
                        x: 297.13,
                        y: 705.74,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 10 (Layer order: 62) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 144.57pt)
                    const wrappedLines = wrapText("TNZN-A1-222", font, 12, 144.57);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 756.00 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 743.24 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 744.00;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 744.00;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 743.24) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 138.90,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("TNZN-A1-222", {
                        x: 138.90,
                        y: 744.00,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 11 (Layer order: 61) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 158.24pt)
                    const wrappedLines = wrapText("7538812218", font, 12, 158.24);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 755.29 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 742.54 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 743.29;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 743.29;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 742.54) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 396.35,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("7538812218", {
                        x: 396.35,
                        y: 743.29,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 12 (Layer order: 60) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 144.57pt)
                    const wrappedLines = wrapText("Mr. SUJITH", font, 12, 144.57);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 737.22 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 724.47 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 725.22;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 725.22;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 724.47) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 138.90,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Mr. SUJITH", {
                        x: 138.90,
                        y: 725.22,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 13 (Layer order: 59) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 144.57pt)
                    const wrappedLines = wrapText("North Street,Tenkasi", font, 11, 144.57);
                    const lineHeight = getLineHeight(11);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (40.97 - totalTextHeight) / 2;
                            startY = 718.45 - 11 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 677.48 + totalTextHeight - 11;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 707.45;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 707.45;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 677.48) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 138.90,
                            y: currentY,
                            size: 11,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 40.97pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("North Street,Tenkasi", {
                        x: 138.90,
                        y: 707.45,
                        size: 11,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 14 (Layer order: 58) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 122.52pt)
                    const wrappedLines = wrapText("Name", font, 12, 122.52);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("center") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (21.68 - totalTextHeight) / 2;
                            startY = 674.78 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 653.10 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 662.78;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 662.78;
                            break;
                    }
                    
                    console.log(`Vertical justification: "center", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 653.10) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 42.52,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 21.68pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Name", {
                        x: 42.52,
                        y: 662.78,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 15 (Layer order: 57) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 44.64pt)
                    const wrappedLines = wrapText("Age", font, 12, 44.64);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("center") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (22.32 - totalTextHeight) / 2;
                            startY = 674.92 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 652.60 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 662.92;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 662.92;
                            break;
                    }
                    
                    console.log(`Vertical justification: "center", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 652.60) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 188.36 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 22.32pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Age", {
                        x: 166.04,
                        y: 662.92,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 16 (Layer order: 56) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 110.70pt)
                    const wrappedLines = wrapText("Relationship", font, 12, 110.70);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("center") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (21.82 - totalTextHeight) / 2;
                            startY = 674.92 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 653.10 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 662.92;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 662.92;
                            break;
                    }
                    
                    console.log(`Vertical justification: "center", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 653.10) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 266.03 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 21.82pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Relationship", {
                        x: 210.68,
                        y: 662.92,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 17 (Layer order: 55) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 142.00pt)
                    const wrappedLines = wrapText("Occupation", font, 12, 142.00);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("center") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (21.67 - totalTextHeight) / 2;
                            startY = 674.78 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 653.10 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 662.78;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 662.78;
                            break;
                    }
                    
                    console.log(`Vertical justification: "center", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 653.10) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 392.88 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 21.67pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Occupation", {
                        x: 321.88,
                        y: 662.78,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 18 (Layer order: 54) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 94.89pt)
                    const wrappedLines = wrapText("Working Place", font, 12, 94.89);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("center") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (21.50 - totalTextHeight) / 2;
                            startY = 674.60 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 653.10 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 662.60;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 662.60;
                            break;
                    }
                    
                    console.log(`Vertical justification: "center", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 653.10) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 511.33 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 21.50pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Working Place", {
                        x: 463.88,
                        y: 662.60,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 19 (Layer order: 53) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 158.74pt)
                    const wrappedLines = wrapText("SAKTHI NAGAR", font, 12, 158.74);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 736.52 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 723.76 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 724.52;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 724.52;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 723.76) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 396.35,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("SAKTHI NAGAR", {
                        x: 396.35,
                        y: 724.52,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 20 (Layer order: 52) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 395.12pt)
                    const wrappedLines = wrapText("Birthday List - From 29.09 to 03.10", font, 12, 395.12);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 782.50 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 766.73 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 770.50;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 770.50;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 766.73) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 301.34 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Birthday List - From 29.09 to 03.10", {
                        x: 103.78,
                        y: 770.50,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 21 (Layer order: 51) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 395.12pt)
                    const wrappedLines = wrapText("Diocese of Tirunelveli - Tenkasi North Zion Nagar Pastorate", font, 12, 395.12);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 800.83 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 785.06 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 788.83;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 788.83;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 785.06) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 297.13 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Diocese of Tirunelveli - Tenkasi North Zion Nagar Pastorate", {
                        x: 99.57,
                        y: 788.83,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 22 (Layer order: 50) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 158.74pt)
                    const wrappedLines = wrapText("Good Health for the Family. Prayers for the Studies ", font, 10, 158.74);
                    const lineHeight = getLineHeight(10);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (40.26 - totalTextHeight) / 2;
                            startY = 717.74 - 10 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 677.48 + totalTextHeight - 10;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 707.74;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 707.74;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 677.48) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 396.35,
                            y: currentY,
                            size: 10,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 40.26pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Good Health for the Family. Prayers for the Studies ", {
                        x: 396.35,
                        y: 707.74,
                        size: 10,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Line 23 (Layer order: 49)
                page.drawLine({
                    start: { x: 165.54, y: 675.99 },
                    end: { x: 165.54, y: 607.29 },
                    thickness: 1.00,
                    color: PDFLib.rgb(0.000, 0.000, 0.000)
                });
                
                // Line 24 (Layer order: 48)
                page.drawLine({
                    start: { x: 211.18, y: 676.13 },
                    end: { x: 211.18, y: 606.95 },
                    thickness: 1.00,
                    color: PDFLib.rgb(0.000, 0.000, 0.000)
                });
                
                // Line 25 (Layer order: 47)
                page.drawLine({
                    start: { x: 321.38, y: 675.79 },
                    end: { x: 321.38, y: 606.61 },
                    thickness: 1.00,
                    color: PDFLib.rgb(0.000, 0.000, 0.000)
                });
                
                // Line 26 (Layer order: 46)
                page.drawLine({
                    start: { x: 464.38, y: 675.70 },
                    end: { x: 464.38, y: 607.29 },
                    thickness: 1.00,
                    color: PDFLib.rgb(0.000, 0.000, 0.000)
                });
                
                // Line 27 (Layer order: 45)
                page.drawLine({
                    start: { x: 36.50, y: 607.11 },
                    end: { x: 558.77, y: 607.11 },
                    thickness: 1.00,
                    color: PDFLib.rgb(0.000, 0.000, 0.000)
                });
                
                // Text Frame 28 (Layer order: 44) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 116.65pt)
                    const wrappedLines = wrapText("Mr. Sujith ", font, 12, 116.65);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 646.48 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 630.71 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 634.48;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 634.48;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 630.71) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 43.80,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Mr. Sujith ", {
                        x: 43.80,
                        y: 634.48,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 29 (Layer order: 43) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 116.65pt)
                    const wrappedLines = wrapText("Mrs. Remina", font, 12, 116.65);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 625.08 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 609.31 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 613.08;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 613.08;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 609.31) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 43.80,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Mrs. Remina", {
                        x: 43.80,
                        y: 613.08,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 30 (Layer order: 42) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 45.64pt)
                    const wrappedLines = wrapText("18", font, 12, 45.64);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 646.48 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 630.71 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 634.48;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 634.48;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 630.71) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 188.36 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("18", {
                        x: 165.54,
                        y: 634.48,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 31 (Layer order: 41) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 45.64pt)
                    const wrappedLines = wrapText("17", font, 12, 45.64);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 625.08 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 609.31 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 613.08;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 613.08;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 609.31) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 188.36 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("17", {
                        x: 165.54,
                        y: 613.08,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 32 (Layer order: 40) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 110.20pt)
                    const wrappedLines = wrapText("Family Head", font, 12, 110.20);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 646.48 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 630.71 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 634.48;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 634.48;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 630.71) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 265.78 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Family Head", {
                        x: 210.68,
                        y: 634.48,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 33 (Layer order: 39) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 110.20pt)
                    const wrappedLines = wrapText("Wife", font, 12, 110.20);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 625.08 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 609.31 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 613.08;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 613.08;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 609.31) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 265.78 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Wife", {
                        x: 210.68,
                        y: 613.08,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 34 (Layer order: 38) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 143.00pt)
                    const wrappedLines = wrapText("Catechist", font, 12, 143.00);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 646.48 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 630.71 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 634.48;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 634.48;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 630.71) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 392.38 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Catechist", {
                        x: 320.88,
                        y: 634.48,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 35 (Layer order: 37) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 143.00pt)
                    const wrappedLines = wrapText("VLSI Er", font, 12, 143.00);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 625.08 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 609.31 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 613.08;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 613.08;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 609.31) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 392.38 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("VLSI Er", {
                        x: 320.88,
                        y: 613.08,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 36 (Layer order: 36) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 94.88pt)
                    const wrappedLines = wrapText("Tenkasi", font, 12, 94.88);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 646.48 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 630.71 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 634.48;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 634.48;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 630.71) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 511.32 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Tenkasi", {
                        x: 463.88,
                        y: 634.48,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 37 (Layer order: 35) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 94.88pt)
                    const wrappedLines = wrapText("Tenkasi", font, 12, 94.88);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 625.08 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 609.31 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 613.08;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 613.08;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 609.31) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 511.32 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Tenkasi", {
                        x: 463.88,
                        y: 613.08,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Line 38 (Layer order: 34)
                page.drawLine({
                    start: { x: 36.00, y: 516.68 },
                    end: { x: 558.71, y: 516.68 },
                    thickness: 1.00,
                    color: PDFLib.rgb(0.000, 0.000, 0.000)
                });
                
                // Line 39 (Layer order: 33)
                page.drawLine({
                    start: { x: 36.00, y: 493.86 },
                    end: { x: 558.71, y: 493.86 },
                    thickness: 1.00,
                    color: PDFLib.rgb(0.000, 0.000, 0.000)
                });
                
                // Text Frame 40 (Layer order: 32) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 88.44pt)
                    const wrappedLines = wrapText("Family Number :", font, 12, 88.44);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 597.26 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 584.50 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 585.26;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 585.26;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 584.50) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 39.63,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Family Number :", {
                        x: 39.63,
                        y: 585.26,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 41 (Layer order: 31) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 88.44pt)
                    const wrappedLines = wrapText("Mobile Number :", font, 12, 88.44);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 596.55 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 583.80 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 584.55;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 584.55;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 583.80) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 297.79,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Mobile Number :", {
                        x: 297.79,
                        y: 584.55,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 42 (Layer order: 30) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 88.44pt)
                    const wrappedLines = wrapText("Family Head :", font, 12, 88.44);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 578.48 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 565.73 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 566.48;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 566.48;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 565.73) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 39.63,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Family Head :", {
                        x: 39.63,
                        y: 566.48,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 43 (Layer order: 29) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 88.44pt)
                    const wrappedLines = wrapText("Address :", font, 12, 88.44);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 559.71 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 546.95 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 547.71;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 547.71;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 546.95) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 39.63,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Address :", {
                        x: 39.63,
                        y: 547.71,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 44 (Layer order: 28) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 88.44pt)
                    const wrappedLines = wrapText("Area :", font, 12, 88.44);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 577.78 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 565.02 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 565.78;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 565.78;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 565.02) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 297.79,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Area :", {
                        x: 297.79,
                        y: 565.78,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 45 (Layer order: 27) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 88.44pt)
                    const wrappedLines = wrapText("Prayer Points :", font, 12, 88.44);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 559.00 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 546.24 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 547.00;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 547.00;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 546.24) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 297.07,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Prayer Points :", {
                        x: 297.07,
                        y: 547.00,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 46 (Layer order: 26) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 144.57pt)
                    const wrappedLines = wrapText("TNZN-A1-222", font, 12, 144.57);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 597.26 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 584.50 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 585.26;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 585.26;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 584.50) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 138.84,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("TNZN-A1-222", {
                        x: 138.84,
                        y: 585.26,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 47 (Layer order: 25) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 158.24pt)
                    const wrappedLines = wrapText("7538812218", font, 12, 158.24);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 596.55 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 583.80 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 584.55;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 584.55;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 583.80) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 396.29,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("7538812218", {
                        x: 396.29,
                        y: 584.55,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 48 (Layer order: 24) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 144.57pt)
                    const wrappedLines = wrapText("Mr. SUJITH", font, 12, 144.57);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 578.48 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 565.73 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 566.48;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 566.48;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 565.73) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 138.84,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Mr. SUJITH", {
                        x: 138.84,
                        y: 566.48,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 49 (Layer order: 23) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 144.57pt)
                    const wrappedLines = wrapText("North Street,Tenkasi", font, 11, 144.57);
                    const lineHeight = getLineHeight(11);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (40.97 - totalTextHeight) / 2;
                            startY = 559.71 - 11 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 518.74 + totalTextHeight - 11;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 548.71;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 548.71;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 518.74) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 138.84,
                            y: currentY,
                            size: 11,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 40.97pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("North Street,Tenkasi", {
                        x: 138.84,
                        y: 548.71,
                        size: 11,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 50 (Layer order: 22) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 122.52pt)
                    const wrappedLines = wrapText("Name", font, 12, 122.52);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("center") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (21.68 - totalTextHeight) / 2;
                            startY = 516.04 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 494.36 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 504.04;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 504.04;
                            break;
                    }
                    
                    console.log(`Vertical justification: "center", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 494.36) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 42.46,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 21.68pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Name", {
                        x: 42.46,
                        y: 504.04,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 51 (Layer order: 21) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 44.64pt)
                    const wrappedLines = wrapText("Age", font, 12, 44.64);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("center") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (22.32 - totalTextHeight) / 2;
                            startY = 516.18 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 493.86 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 504.18;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 504.18;
                            break;
                    }
                    
                    console.log(`Vertical justification: "center", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 493.86) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 188.31 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 22.32pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Age", {
                        x: 165.99,
                        y: 504.18,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 52 (Layer order: 20) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 110.70pt)
                    const wrappedLines = wrapText("Relationship", font, 12, 110.70);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("center") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (21.82 - totalTextHeight) / 2;
                            startY = 516.18 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 494.36 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 504.18;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 504.18;
                            break;
                    }
                    
                    console.log(`Vertical justification: "center", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 494.36) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 265.97 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 21.82pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Relationship", {
                        x: 210.62,
                        y: 504.18,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 53 (Layer order: 19) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 142.00pt)
                    const wrappedLines = wrapText("Occupation", font, 12, 142.00);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("center") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (21.67 - totalTextHeight) / 2;
                            startY = 516.04 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 494.36 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 504.04;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 504.04;
                            break;
                    }
                    
                    console.log(`Vertical justification: "center", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 494.36) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 392.83 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 21.67pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Occupation", {
                        x: 321.83,
                        y: 504.04,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 54 (Layer order: 18) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 94.89pt)
                    const wrappedLines = wrapText("Working Place", font, 12, 94.89);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("center") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (21.50 - totalTextHeight) / 2;
                            startY = 515.86 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 494.36 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 503.86;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 503.86;
                            break;
                    }
                    
                    console.log(`Vertical justification: "center", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 494.36) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 511.27 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 21.50pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Working Place", {
                        x: 463.83,
                        y: 503.86,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 55 (Layer order: 17) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 158.74pt)
                    const wrappedLines = wrapText("SAKTHI NAGAR", font, 12, 158.74);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (12.76 - totalTextHeight) / 2;
                            startY = 577.78 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 565.02 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 565.78;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 565.78;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 565.02) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 396.29,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 12.76pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("SAKTHI NAGAR", {
                        x: 396.29,
                        y: 565.78,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 56 (Layer order: 16) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 158.74pt)
                    const wrappedLines = wrapText("Good Health for the Family. Prayers for the Studies ", font, 10, 158.74);
                    const lineHeight = getLineHeight(10);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (40.26 - totalTextHeight) / 2;
                            startY = 559.00 - 10 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 518.74 + totalTextHeight - 10;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 549.00;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 549.00;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 518.74) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 396.29,
                            y: currentY,
                            size: 10,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 40.26pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Good Health for the Family. Prayers for the Studies ", {
                        x: 396.29,
                        y: 549.00,
                        size: 10,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Line 57 (Layer order: 15)
                page.drawLine({
                    start: { x: 165.49, y: 517.25 },
                    end: { x: 165.49, y: 448.55 },
                    thickness: 1.00,
                    color: PDFLib.rgb(0.000, 0.000, 0.000)
                });
                
                // Line 58 (Layer order: 14)
                page.drawLine({
                    start: { x: 211.12, y: 517.39 },
                    end: { x: 211.12, y: 448.21 },
                    thickness: 1.00,
                    color: PDFLib.rgb(0.000, 0.000, 0.000)
                });
                
                // Line 59 (Layer order: 13)
                page.drawLine({
                    start: { x: 321.33, y: 517.05 },
                    end: { x: 321.33, y: 447.87 },
                    thickness: 1.00,
                    color: PDFLib.rgb(0.000, 0.000, 0.000)
                });
                
                // Line 60 (Layer order: 12)
                page.drawLine({
                    start: { x: 464.33, y: 516.96 },
                    end: { x: 464.33, y: 448.55 },
                    thickness: 1.00,
                    color: PDFLib.rgb(0.000, 0.000, 0.000)
                });
                
                // Line 61 (Layer order: 11)
                page.drawLine({
                    start: { x: 36.44, y: 448.37 },
                    end: { x: 558.71, y: 448.37 },
                    thickness: 1.00,
                    color: PDFLib.rgb(0.000, 0.000, 0.000)
                });
                
                // Text Frame 62 (Layer order: 10) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 116.65pt)
                    const wrappedLines = wrapText("Mr. Sujith ", font, 12, 116.65);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 487.74 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 471.97 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 475.74;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 475.74;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 471.97) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 43.74,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Mr. Sujith ", {
                        x: 43.74,
                        y: 475.74,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 63 (Layer order: 9) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 116.65pt)
                    const wrappedLines = wrapText("Mrs. Remina", font, 12, 116.65);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 466.34 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 450.57 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 454.34;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 454.34;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 450.57) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Left alignment
                        page.drawText(line, {
                            x: 43.74,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Mrs. Remina", {
                        x: 43.74,
                        y: 454.34,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 64 (Layer order: 8) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 45.64pt)
                    const wrappedLines = wrapText("18", font, 12, 45.64);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 487.74 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 471.97 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 475.74;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 475.74;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 471.97) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 188.31 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("18", {
                        x: 165.49,
                        y: 475.74,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 65 (Layer order: 7) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 45.64pt)
                    const wrappedLines = wrapText("17", font, 12, 45.64);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 466.34 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 450.57 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 454.34;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 454.34;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 450.57) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 188.31 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("17", {
                        x: 165.49,
                        y: 454.34,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 66 (Layer order: 6) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 110.20pt)
                    const wrappedLines = wrapText("Family Head", font, 12, 110.20);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 487.74 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 471.97 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 475.74;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 475.74;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 471.97) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 265.72 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Family Head", {
                        x: 210.62,
                        y: 475.74,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 67 (Layer order: 5) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 110.20pt)
                    const wrappedLines = wrapText("Wife", font, 12, 110.20);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 466.34 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 450.57 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 454.34;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 454.34;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 450.57) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 265.72 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Wife", {
                        x: 210.62,
                        y: 454.34,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 68 (Layer order: 4) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 143.00pt)
                    const wrappedLines = wrapText("Catechist", font, 12, 143.00);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 487.74 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 471.97 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 475.74;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 475.74;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 471.97) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 392.33 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Catechist", {
                        x: 320.83,
                        y: 475.74,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 69 (Layer order: 3) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 143.00pt)
                    const wrappedLines = wrapText("VLSI Er", font, 12, 143.00);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 466.34 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 450.57 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 454.34;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 454.34;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 450.57) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 392.33 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("VLSI Er", {
                        x: 320.83,
                        y: 454.34,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 70 (Layer order: 2) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 94.88pt)
                    const wrappedLines = wrapText("Tenkasi", font, 12, 94.88);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 487.74 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 471.97 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 475.74;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 475.74;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 471.97) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 511.27 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Tenkasi", {
                        x: 463.83,
                        y: 475.74,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Text Frame 71 (Layer order: 1) - WITH TEXT WRAPPING
                try {
                    // Embed standard font
                    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.TimesRoman);
                    
                    // Text wrapping within frame bounds (width: 94.88pt)
                    const wrappedLines = wrapText("Tenkasi", font, 12, 94.88);
                    const lineHeight = getLineHeight(12);
                    const totalTextHeight = wrappedLines.length * lineHeight;
                    
                    // Calculate starting Y position based on vertical justification
                    let startY;
                    
                    // Apply vertical justification
                    switch ("top") {
                        case "center":
                            // Center the text block vertically in the frame
                            const centerOffset = (15.77 - totalTextHeight) / 2;
                            startY = 466.34 - 12 - centerOffset;
                            break;
                        case "bottom":
                            // Align text to bottom of frame
                            startY = 450.57 + totalTextHeight - 12;
                            break;
                        case "justify":
                            // For now, treat justify as top (could be enhanced later)
                            startY = 454.34;
                            break;
                        default: // "top"
                            // Align text to top of frame (original behavior)
                            startY = 454.34;
                            break;
                    }
                    
                    console.log(`Vertical justification: "top", startY: ${startY}, totalTextHeight: ${totalTextHeight}`);
                    
                    // Draw each line
                    for (let lineIdx = 0; lineIdx < wrappedLines.length; lineIdx++) {
                        const line = wrappedLines[lineIdx];
                        const currentY = startY - (lineIdx * lineHeight);
                        
                        // Skip lines that would fall below the text frame
                        if (currentY < 450.57) {
                            console.log(`Line ${lineIdx + 1} clipped: "${line}" (Y: ${currentY})`);
                            continue;
                        }
                        
                        // Center alignment
                        const lineWidth = font.widthOfTextAtSize(line, 12);
                        const centeredX = 511.27 - (lineWidth / 2);
                        
                        page.drawText(line, {
                            x: centeredX,
                            y: currentY,
                            size: 12,
                            font: font,
                            color: PDFLib.rgb(0.000, 0.000, 0.000)
                        });
                    }
                    
                    console.log(`Text frame rendered: ${wrappedLines.length} lines, frame height: 15.77pt`);
                } catch (fontError) {
                    console.error("Error rendering text:", fontError);
                    // Fallback: draw text without wrapping
                    page.drawText("Tenkasi", {
                        x: 463.83,
                        y: 454.34,
                        size: 12,
                        color: PDFLib.rgb(0.000, 0.000, 0.000)
                    });
                }
                
                // Rectangle 72 (Layer order: 0)
                page.drawRectangle({
                    x: 37.00,
                    y: 36.50,
                    width: 522.28,
                    height: 768.89,
                    borderColor: PDFLib.rgb(0.000, 0.000, 0.000),
                    borderWidth: 1.00
                });
                
                // Serialize the PDF document to bytes
                console.log("Serializing PDF for viewing...");
                const pdfBytes = await pdfDoc.save();
                
                // Create a blob and open in new tab
                const blob = new Blob([pdfBytes], { type: "application/pdf" });
                const url = URL.createObjectURL(blob);
                
                // Open PDF in new tab for viewing
                const newWindow = window.open(url, "_blank");
                if (!newWindow) {
                    alert("Popup blocked! Please allow popups and try again.");
                    return;
                }
                
                // Clean up the URL after a delay
                setTimeout(() => {
                    URL.revokeObjectURL(url);
                }, 10000); // 10 seconds delay
                
                console.log("PDF opened in new tab for viewing!");
                
            } catch (error) {
                console.error("PDF View Error:", error);
                alert("PDF viewing failed: " + error.message);
            }
        }
        
        // Helper function to convert hex color to RGB values (0-1 range)
        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16) / 255,
                g: parseInt(result[2], 16) / 255,
                b: parseInt(result[3], 16) / 255
            } : {r: 0, g: 0, b: 0};
        }
        
        // Helper function to convert degrees to radians
        function degreesToRadians(degrees) {
            return degrees * Math.PI / 180;
        }
        
        // Helper function to wrap text within a given width
        function wrapText(text, font, fontSize, maxWidth) {
            if (!text || text.trim() === "") return [];
            
            const words = text.split(/\s+/);
            const lines = [];
            let currentLine = "";
            
            for (let i = 0; i < words.length; i++) {
                const word = words[i];
                const testLine = currentLine + (currentLine ? " " : "") + word;
                const testWidth = font.widthOfTextAtSize(testLine, fontSize);
                
                if (testWidth <= maxWidth || currentLine === "") {
                    currentLine = testLine;
                } else {
                    if (currentLine) {
                        lines.push(currentLine);
                    }
                    currentLine = word;
                }
            }
            
            if (currentLine) {
                lines.push(currentLine);
            }
            
            return lines;
        }
        
        // Helper function to calculate line height (font size * line spacing factor)
        function getLineHeight(fontSize) {
            return fontSize * 1.2; // Standard line spacing factor
        }
    </script>
</body>
</html>